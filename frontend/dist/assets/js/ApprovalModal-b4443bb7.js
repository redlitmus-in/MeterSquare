import{j as e}from"./radix-ui-34961435.js";import{r as s}from"./react-vendor-3707ac94.js";import{D as a,a as r,b as i,c as t,d as l,e as c}from"./dialog-d443819a.js";import{B as n}from"./index-12cad093.js";import{L as o}from"./label-d100d551.js";import{T as d}from"./textarea-ff7bd289.js";import{R as m,a as h}from"./radio-group-188286ff.js";import{A as j,a as x}from"./alert-409df19c.js";import{i as p,v as u,w as v,az as g,I as f}from"./icons-2fde7931.js";const N=[{value:"budget_exceeded",label:"Budget Exceeded"},{value:"specification_mismatch",label:"Specification Mismatch"},{value:"quantity_issue",label:"Quantity Issue"},{value:"vendor_concern",label:"Vendor Concern"},{value:"quality_concern",label:"Quality Concern"},{value:"timing_issue",label:"Timing Issue"},{value:"duplicate_request",label:"Duplicate Request"},{value:"other",label:"Other (specify in comments)"}],b=({isOpen:b,onClose:y,purchase:w,mode:_,onConfirm:C,isLoading:P=!1})=>{const[q,R]=s.useState(""),[F,T]=s.useState(""),[A,k]=s.useState(""),I=()=>{R(""),T(""),k(""),y()};if(!w)return null;return e.jsx(a,{open:b,onOpenChange:I,children:e.jsxs(r,{className:"max-w-2xl",children:[e.jsxs(i,{children:[e.jsx(t,{className:"flex items-center gap-2",children:"approve"===_?e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"h-5 w-5 text-green-600"}),"Approve Purchase Request"]}):e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"h-5 w-5 text-red-600"}),"Reject Purchase Request"]})}),e.jsxs(l,{children:["Purchase #",w.purchase_id," - ",w.site_location]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Purpose:"}),e.jsx("p",{className:"font-medium",children:w.purpose})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Total Cost:"}),e.jsx("p",{className:"font-medium",children:(O=w.materials_summary.total_cost,`AED ${O.toLocaleString()}`)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Materials:"}),e.jsxs("p",{className:"font-medium",children:[w.materials_summary.total_materials," items"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Categories:"}),e.jsx("p",{className:"font-medium",children:w.materials_summary.categories.join(", ")})]})]})}),"reject"===_&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(v,{className:"h-4 w-4"}),"Rejection Reason *"]}),e.jsx(m,{value:q,onValueChange:R,children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:N.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{value:s.value,id:s.value}),e.jsx(o,{htmlFor:s.value,className:"font-normal cursor-pointer",children:s.label})]},s.value))})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"comments",className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-4 w-4"}),"Comments ","reject"===_&&"other"===q&&"*"]}),e.jsx(d,{id:"comments",placeholder:"approve"===_?"Add any additional comments or conditions...":"Provide detailed feedback for the procurement team...",value:F,onChange:e=>T(e.target.value),rows:4,className:"resize-none"})]}),"approve"===_?e.jsxs(j,{children:[e.jsx(f,{className:"h-4 w-4"}),e.jsxs(x,{children:["By approving this purchase request, you confirm that:",e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-1 text-sm",children:[e.jsx("li",{children:"The specifications meet project requirements"}),e.jsx("li",{children:"The quantities are appropriate for the project"}),e.jsx("li",{children:"The request will be forwarded to the Estimation team"})]})]})]}):e.jsxs(j,{className:"border-orange-200 bg-orange-50",children:[e.jsx(v,{className:"h-4 w-4 text-orange-600"}),e.jsx(x,{children:"This purchase request will be sent back to the Procurement team for revision. Please provide clear feedback to help them address the issues."})]}),A&&e.jsxs(j,{variant:"destructive",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx(x,{children:A})]})]}),e.jsxs(c,{children:[e.jsx(n,{variant:"outline",onClick:I,disabled:P,children:"Cancel"}),e.jsx(n,{onClick:()=>{k(""),"reject"!==_||q?"reject"!==_||"other"!==q||F.trim()?w&&(C({purchaseId:w.purchase_id,action:_,rejectionReason:"reject"===_?N.find(e=>e.value===q)?.label||q:void 0,comments:F.trim()||void 0}),R(""),T(""),k("")):k('Please provide details in comments for "Other" rejection reason'):k("Please select a rejection reason")},disabled:P,className:"approve"===_?"bg-green-600 hover:bg-green-700":"",variant:"reject"===_?"destructive":"default",children:P?"Processing...":e.jsx(e.Fragment,{children:"approve"===_?e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),"Approve Purchase"]}):e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"h-4 w-4 mr-2"}),"Reject Purchase"]})})})]})]})});var O};export{b as A};
